---
import BlogPost from "../../layouts/BlogPost.astro";
import { ghostClient } from "../../lib/ghost";

export const prerender = false;

export async function getStaticPaths() {
  const posts = await ghostClient.posts
    .browse({
      limit: "all",
    })
    .catch((err) => {
      console.error(err);
    });

  return posts.map((post) => {
    return {
      params: {
        slug: post.slug,
      },
      props: {
        post: post,
      },
    };
  });
}

const { post } = Astro.props;
const props = {
  title: post.title,
  description: post.description,
  pubDate: new Date(post.published_at),
  updatedDate: new Date(post.updated_at || post.published_at),
  heroImage: post.featured_image,
};
console.log(props);
---

<BlogPost {...props}>
  <Fragment set:html={post.html} />
</BlogPost>
